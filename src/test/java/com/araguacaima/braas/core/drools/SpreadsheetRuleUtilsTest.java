package com.araguacaima.braas.core.drools;

import com.araguacaima.braas.core.SpreadsheetRuleUtils;
import com.araguacaima.braas.core.drools.model.forms.Form;
import com.araguacaima.braas.core.exception.InternalBraaSException;
import com.araguacaima.commons.utils.JsonUtils;
import org.junit.Assert;
import org.junit.Test;

import java.io.IOException;
import java.util.Collection;
import java.util.LinkedList;

public class SpreadsheetRuleUtilsTest {

    private static JsonUtils jsonUtils = new JsonUtils();
    private String fieldSeparator = "$$$###$$$";
    private String headerSeparator = "#$#$#$#$#";
    private String prefix = "form";
    private String matrixStr = "form.id$$$###$$$form.locale$$$###$$$form.title$$$###$$$form.description$$$###$$$form.questions.id$$$###$$$form.questions.title$$$###$$$form.questions.description$$$###$$$form.questions.type$$$###$$$form.questions.category$$$###$$$form.questions.options.id$$$###$$$form.questions.options.title$$$###$$$form.questions.options.description$$$###$$$form.questions.options.isText$$$###$$$form.questions.options.weighting$$$###$$$#$#$#$#$#$$$###$$$60bf396c-5c08-42a4-9d78-7100eb3c979c$$$###$$$ES$$$###$$$Primer paso$$$###$$$Cras placerat nisi in lorem consectetur ultrices.$$$###$$$4b44037b-a78d-4a64-bd07-617f8111a9b3$$$###$$$Neque porro quisquam est qui dolorem ipsum quia dolor sit amet, consectetur, adipisci velitâ€¦$$$###$$$Quisque vestibulum augue quis justo euismod, sed dapibus diam ultricies.$$$###$$$SINGLE$$$###$$$CATEGORY_1$$$###$$$238418fd-82e9-4c31-af66-0cd669901141$$$###$$$Fusce eget nibh a tortor ornare euismod in fringilla sapien.$$$###$$$Sed a nunc vitae magna dapibus ultricies.$$$###$$$FALSE$$$###$$$4$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$d64bb541-2876-4cd1-ac79-0b39ea80f17e$$$###$$$Nam sit amet elit eget urna consectetur aliquam in quis dui.$$$###$$$Curabitur et sem tristique, tempor sapien at, maximus elit.$$$###$$$FALSE$$$###$$$3$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$6d02efd3-aad0-4fd8-8fe6-f983840e4e21$$$###$$$Donec ac mi non eros volutpat vulputate.$$$###$$$Nam eu nunc elementum, congue lectus sit amet, euismod tortor.$$$###$$$FALSE$$$###$$$5$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$1339b2ed-5701-4e8f-bf83-72fbdb997ec4$$$###$$$Lorem ipsum dolor sit amet, consectetur adipiscing elit.$$$###$$$Vestibulum quis lorem mollis quam ornare imperdiet.$$$###$$$MULTIPLE$$$###$$$CATEGORY_2$$$###$$$76c3b14f-ce3a-4a1c-9d5b-23981cc2cf75$$$###$$$Mauris egestas ligula sit amet pulvinar dapibus.$$$###$$$Morbi ultricies justo in lectus ultrices, ut interdum est vulputate.$$$###$$$FALSE$$$###$$$1$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$5144d90d-95f9-42ec-9c29-b045052ffef1$$$###$$$Nam fringilla eros quis nisl placerat, in ultrices nibh eleifend.$$$###$$$Vestibulum congue eros laoreet nulla egestas pellentesque.$$$###$$$FALSE$$$###$$$2$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$7e87702f-f886-4f23-a45a-cf83016140c3$$$###$$$Nam cursus elit euismod, facilisis lacus rutrum, dictum purus.$$$###$$$Nunc pharetra felis quis aliquet eleifend.$$$###$$$FALSE$$$###$$$4$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$48720ad6-fae7-4378-a848-d1a7f0f66637$$$###$$$Sed ac diam vitae purus tristique egestas.$$$###$$$Praesent blandit ex quis leo molestie imperdiet.$$$###$$$FALSE$$$###$$$3$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$424f19dc-a4ee-4402-827a-d0457173967c$$$###$$$Aenean pellentesque quam ut ipsum porttitor volutpat.$$$###$$$Aliquam ultricies ex eu purus pretium, sed porta urna vehicula.$$$###$$$MULTIPLE$$$###$$$CATEGORY_1$$$###$$$ad2d5253-cce5-400e-a675-c6803863fb74$$$###$$$Etiam ut sem aliquet, porta enim ut, venenatis dui.$$$###$$$Etiam bibendum velit eget justo interdum malesuada.$$$###$$$FALSE$$$###$$$5$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$80b79825-e5f3-4603-aeb1-e833a61a40d3$$$###$$$Suspendisse lacinia lectus hendrerit maximus efficitur.$$$###$$$Integer gravida nisl ut pellentesque dictum.$$$###$$$FALSE$$$###$$$4$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$93b33067-da27-474b-81f7-a3be8926875c$$$###$$$Etiam sodales mi vel ante posuere dapibus.$$$###$$$Duis at magna nec lectus suscipit sollicitudin vel sed dolor.$$$###$$$FALSE$$$###$$$2$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$b7dec3d9-1f9a-4269-9e0f-2e50e42efec1$$$###$$$Maecenas non dolor et mauris vehicula sagittis.$$$###$$$Vestibulum blandit justo vitae massa dictum, non suscipit quam scelerisque.$$$###$$$TRUE$$$###$$$3$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$96321bc1-00a3-4c61-8c5b-d54cadf677d1$$$###$$$Mauris ultricies ante nec turpis vulputate dapibus.$$$###$$$Sed in urna sed libero euismod fringilla.$$$###$$$MULTIPLE$$$###$$$CATEGORY_2$$$###$$$c473eccd-3dec-492a-bcb5-a19aa66a95d8$$$###$$$Maecenas tincidunt mi sit amet commodo pellentesque.$$$###$$$Phasellus rhoncus tellus sit amet ligula cursus, ac euismod orci bibendum.$$$###$$$FALSE$$$###$$$1$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$d52f7c99-6a5e-4a1e-af20-57ba8076aff5$$$###$$$Sed accumsan turpis ut dolor tincidunt, eget bibendum urna luctus.$$$###$$$Morbi sit amet nisl a urna varius pharetra ut non erat.$$$###$$$FALSE$$$###$$$4$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$ac86c2a4-8d27-455f-9715-3d3d89857239$$$###$$$Donec lobortis justo nec erat consequat, et auctor mi sodales.$$$###$$$Donec in nisl at dui egestas euismod.$$$###$$$FALSE$$$###$$$5$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$32ef91bd-ddc4-487d-a458-38c9f24b3f23$$$###$$$Praesent vel enim id quam lacinia rhoncus eu id turpis.$$$###$$$Quisque et lectus pharetra, tempor dui nec, euismod nisl.$$$###$$$TRUE$$$###$$$2$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$a300bd8a-981e-4b39-a2dc-59aba319be1f$$$###$$$Donec ac dolor sit amet risus convallis pulvinar in in augue.$$$###$$$Nullam ac quam tincidunt, tristique ex et, varius nunc.$$$###$$$SINGLE$$$###$$$CATEGORY_2$$$###$$$59b2b495-5cf3-48c7-8068-f26105864a93$$$###$$$Pellentesque nec magna ac quam fringilla laoreet.$$$###$$$Quisque aliquet quam vel posuere sollicitudin.$$$###$$$FALSE$$$###$$$3$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$c70421fb-b3ca-4a90-8a64-752e7f579031$$$###$$$In eu justo dignissim, maximus velit a, accumsan leo.$$$###$$$Sed euismod leo sed felis ultricies, sed rhoncus nibh ornare.$$$###$$$FALSE$$$###$$$2$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$5b0507f9-7681-4400-8302-8d799dd42d1d$$$###$$$Donec at eros eget augue luctus lacinia ac et lacus.$$$###$$$Donec hendrerit nunc eget commodo posuere.$$$###$$$SINGLE$$$###$$$CATEGORY_1$$$###$$$8b456ec9-3503-440e-a852-eb3282a98d12$$$###$$$Praesent non velit rhoncus eros sagittis euismod.$$$###$$$Fusce sed ligula at lorem faucibus placerat quis ac nibh.$$$###$$$FALSE$$$###$$$4$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$afa38946-91c0-431e-b679-867cc814b2dd$$$###$$$Praesent venenatis mauris vel sapien suscipit, a tempor augue elementum.$$$###$$$Nulla a felis ut nulla semper congue eget at magna.$$$###$$$FALSE$$$###$$$5$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$35b626fa-160a-4169-901c-d31820ee3299$$$###$$$Vestibulum ac dui nec turpis imperdiet volutpat eget ut mi.$$$###$$$Ut volutpat velit eu elit volutpat, at vestibulum elit tincidunt.$$$###$$$SINGLE$$$###$$$CATEGORY_1$$$###$$$09f79774-b072-424d-9c63-7a99a633e0cd$$$###$$$Vivamus cursus nunc a consequat pellentesque.$$$###$$$Donec dapibus erat et nibh ultricies venenatis.$$$###$$$FALSE$$$###$$$1$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$SINGLE$$$###$$$CATEGORY_1$$$###$$$557d998d-e450-4a5a-960a-dc0fd687b52d$$$###$$$Mauris a massa laoreet, lacinia tellus vel, commodo lectus.$$$###$$$Morbi posuere odio a ante malesuada pharetra.$$$###$$$FALSE$$$###$$$2$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$7201dcf4-b09f-4b8c-804c-4dc1acb87ff8$$$###$$$Phasellus suscipit mi sagittis, ornare nibh a, efficitur libero.$$$###$$$Ut sed nisl ultricies, porta neque vitae, dapibus dui.$$$###$$$SINGLE$$$###$$$CATEGORY_2$$$###$$$4a153bc2-ea0a-4087-9414-4ae88a0f47a1$$$###$$$Duis dapibus diam eget fermentum rhoncus.$$$###$$$Praesent hendrerit lacus aliquam, facilisis purus in, pharetra leo.$$$###$$$FALSE$$$###$$$4$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$00f5caa5-2ad5-4826-ad6a-1bcaeec95bf4$$$###$$$Duis ut augue faucibus, egestas sem et, volutpat nisl.$$$###$$$Praesent cursus magna nec lectus aliquam molestie.$$$###$$$FALSE$$$###$$$2$$$###$$$e122af1f-1a78-4245-864e-42ee1afbd43b$$$###$$$EN$$$###$$$First Step$$$###$$$Vivamus tincidunt magna vitae lacus blandit ultrices.$$$###$$$4e5a67c4-b02e-45dd-be94-d675b622f22a$$$###$$$Maecenas auctor ligula ac purus interdum, eget porta ipsum iaculis.$$$###$$$Nullam non nunc porta, porttitor odio fringilla, accumsan lectus.$$$###$$$SINGLE$$$###$$$CATEGORY_1$$$###$$$cedc0392-3f51-4d6c-b811-1e04eb1ef348$$$###$$$Sed tristique erat id hendrerit maximus.$$$###$$$Suspendisse a leo nec lorem pretium aliquet.$$$###$$$FALSE$$$###$$$3$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$653bebce-2b48-46d9-b7a5-442b4eaeb2da$$$###$$$Sed vel metus volutpat, feugiat leo eget, cursus nisl.$$$###$$$Nullam quis ante sed lorem rutrum aliquet nec malesuada quam.$$$###$$$FALSE$$$###$$$4$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$86930cd6-432a-463c-bebf-33da85b2a5a7$$$###$$$Nam eget augue a tortor dictum fermentum id in velit.$$$###$$$Aliquam euismod massa quis odio egestas venenatis.$$$###$$$FALSE$$$###$$$4$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$6b0af969-36ea-421b-a6ff-174c2290e607$$$###$$$Type of infrastructure in which the SaaS is deployed$$$###$$$Proin ut tortor facilisis, pretium ex et, eleifend eros.$$$###$$$MULTIPLE$$$###$$$CATEGORY_2$$$###$$$95259b64-a4c3-4ba2-99dc-25c755ad7797$$$###$$$Praesent interdum sapien et dolor ultrices commodo.$$$###$$$In quis ipsum sed nulla facilisis mattis.$$$###$$$FALSE$$$###$$$1$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$9cfb7cca-9997-4814-afb2-b0a3d06e5d43$$$###$$$In in risus ac ipsum aliquam tristique sit amet id arcu.$$$###$$$Nam euismod sem vel neque gravida, a pellentesque est vehicula.$$$###$$$FALSE$$$###$$$2$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$75f75909-2a77-4fde-be2b-2f893435ec81$$$###$$$Aliquam in enim ac enim pellentesque fringilla in at massa.$$$###$$$Donec ac erat in dui dictum pulvinar.$$$###$$$FALSE$$$###$$$2$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$5d811c4d-57c5-4936-8ad9-273266d19250$$$###$$$Quisque vulputate quam vitae ex sollicitudin, vel faucibus tortor tincidunt.$$$###$$$Pellentesque efficitur est et velit auctor, ac fringilla orci tristique.$$$###$$$FALSE$$$###$$$2$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$5c1454c6-663d-4df7-a4ef-8161a077594e$$$###$$$Phasellus vehicula turpis vel augue tempus pulvinar.$$$###$$$Quisque consectetur mi sit amet tortor consequat accumsan in in sapien.$$$###$$$MULTIPLE$$$###$$$CATEGORY_1$$$###$$$ae474867-b888-4db5-b35b-d530a49186c1$$$###$$$Cras suscipit lectus non nulla mollis, ac tristique ex dictum.$$$###$$$Proin elementum ligula et nisi dignissim ullamcorper.$$$###$$$FALSE$$$###$$$3$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$12c20470-c8a0-4411-b7bd-bb6139df2205$$$###$$$Suspendisse in dui tempus, gravida elit in, pellentesque velit.$$$###$$$Phasellus in nisl porttitor, porttitor nisl et, elementum nisi.$$$###$$$FALSE$$$###$$$1$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$38cb270f-239d-411a-8a5b-0be7483fff44$$$###$$$Mauris efficitur felis eget odio rhoncus, at bibendum odio dictum.$$$###$$$Morbi commodo dui eget nisl efficitur, euismod congue ipsum semper.$$$###$$$FALSE$$$###$$$1$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$902fa5f1-f0ec-4124-b035-9bdd118b8ade$$$###$$$Phasellus cursus enim ut nisl blandit, sed pharetra diam rhoncus.$$$###$$$Mauris eget sem lobortis nibh porttitor ornare.$$$###$$$TRUE$$$###$$$1$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$f5c3b769-95c8-4d36-9b1f-5e3bab8a6db8$$$###$$$Fusce at nibh a nisi pulvinar laoreet a eget tortor.$$$###$$$Praesent tincidunt tortor eu est egestas, id molestie nisi posuere.$$$###$$$MULTIPLE$$$###$$$CATEGORY_2$$$###$$$f1f3bbb2-c9e2-42f7-ae0b-d967f658b739$$$###$$$Sed non lacus fermentum, fringilla metus sit amet, interdum odio.$$$###$$$Vivamus eu justo interdum justo aliquam facilisis eget sed velit.$$$###$$$FALSE$$$###$$$3$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$fc9fbbd8-cdbc-4a1e-99b1-0cbd135e6d1a$$$###$$$Aenean a urna id arcu convallis elementum.$$$###$$$Aenean venenatis est ac mi rhoncus, ac pharetra metus luctus.$$$###$$$FALSE$$$###$$$4$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$d0443bb4-4d38-4f82-b7f6-93dfdc4ad4d6$$$###$$$Duis commodo erat at ligula vehicula, eget dapibus libero pulvinar.$$$###$$$Aliquam id magna vel purus hendrerit imperdiet.$$$###$$$FALSE$$$###$$$5$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$65fdb489-7b58-488e-ab86-e9fd562e3d3c$$$###$$$Ut eu mauris eu tellus bibendum gravida.$$$###$$$Nunc pretium ipsum vel iaculis sollicitudin.$$$###$$$TRUE$$$###$$$3$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$dbdc003c-84c0-47c5-82a7-f234e397b33a$$$###$$$Nam posuere ex sit amet lacus aliquam interdum.$$$###$$$Cras gravida nibh bibendum hendrerit maximus.$$$###$$$SINGLE$$$###$$$CATEGORY_2$$$###$$$9c25b39a-2252-43a9-a7e6-7d8ccbb3ed3e$$$###$$$Proin fermentum magna at magna molestie, ac rutrum ante interdum.$$$###$$$Fusce at dui eget sapien eleifend molestie.$$$###$$$FALSE$$$###$$$2$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$8fe5ce7c-5b2e-4ac1-9332-9ebb37fd8fe8$$$###$$$Phasellus sollicitudin quam ut urna auctor congue.$$$###$$$Praesent nec felis et est iaculis condimentum.$$$###$$$FALSE$$$###$$$3$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$316de46c-ea36-4439-b694-7c5ff13b97a1$$$###$$$Maecenas id ligula bibendum, laoreet dui id, euismod tortor.$$$###$$$In id est a arcu convallis suscipit.$$$###$$$SINGLE$$$###$$$CATEGORY_1$$$###$$$5003adbe-5ab9-4957-8e41-c5fe29f36a0b$$$###$$$Aenean maximus nisl quis odio mollis elementum.$$$###$$$Aenean hendrerit est dignissim neque fringilla, et vestibulum nisl lacinia.$$$###$$$FALSE$$$###$$$2$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$78db13e7-bfd0-4859-8c49-ede18210d93e$$$###$$$Nunc at ligula at risus facilisis interdum porttitor et diam.$$$###$$$Maecenas tempor nisi sed ipsum imperdiet consequat.$$$###$$$FALSE$$$###$$$3$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$3c0fe11e-4d64-44ac-aa8f-78e9e000372b$$$###$$$Nam imperdiet sapien non ex interdum iaculis.$$$###$$$Mauris varius felis ut ipsum malesuada, vitae aliquam orci finibus.$$$###$$$SINGLE$$$###$$$CATEGORY_1$$$###$$$8f7551c2-530f-4ac6-836f-3e7e9dc608ce$$$###$$$Etiam eleifend odio non nisi facilisis sagittis.$$$###$$$Morbi quis mi hendrerit risus mattis aliquet nec ut nulla.$$$###$$$FALSE$$$###$$$4$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$SINGLE$$$###$$$CATEGORY_1$$$###$$$2a5c71a8-5178-4370-9c4e-ce335c158c6c$$$###$$$Vivamus vitae neque at dolor hendrerit ornare.$$$###$$$Integer sollicitudin sapien egestas, gravida orci et, dapibus felis.$$$###$$$FALSE$$$###$$$2$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$ee1d2e8e-8730-4e84-ac19-6e932e0ef977$$$###$$$Mauris id lectus in dui pretium eleifend ut in turpis.$$$###$$$Sed commodo nulla vel blandit gravida.$$$###$$$SINGLE$$$###$$$CATEGORY_2$$$###$$$4689b7ce-a5a0-4285-a0b9-fe01c75f4299$$$###$$$Fusce auctor velit ut ligula facilisis, sed ornare risus imperdiet.$$$###$$$Maecenas at metus vitae augue placerat vulputate quis eu elit.$$$###$$$FALSE$$$###$$$3$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$945ca280-729a-44e0-a9ce-998d642baf7c$$$###$$$Nam iaculis justo vitae lorem eleifend, sit amet molestie felis interdum.$$$###$$$Nunc commodo dolor eget fermentum placerat.$$$###$$$FALSE$$$###$$$1$$$###$$$a4ef5665-f777-4f69-8cfd-e84d246c04f4$$$###$$$ES$$$###$$$Segundo paso$$$###$$$Integer vel purus eget libero vulputate finibus sodales sed orci.$$$###$$$d76c6fa7-31a5-44e3-9c14-f05b10bde716$$$###$$$Maecenas nec nisi nec lorem egestas porta.$$$###$$$Nunc sed enim blandit, tempus ante at, porttitor dolor.$$$###$$$SINGLE$$$###$$$CATEGORY_1$$$###$$$3f596ead-7839-4db8-b045-32cc16811c4a$$$###$$$Morbi non libero vel ex mattis commodo nec quis nunc.$$$###$$$Aliquam vitae urna at nunc pellentesque ullamcorper.$$$###$$$FALSE$$$###$$$1$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$41f0bd08-648a-4c70-9e7b-e56219303c07$$$###$$$Integer porta tellus id justo laoreet, eget facilisis nibh malesuada.$$$###$$$Vestibulum nec elit ac dui porta sollicitudin.$$$###$$$FALSE$$$###$$$1$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$e42cf452-2593-4f7c-a150-027a0186b354$$$###$$$Proin euismod justo luctus felis rhoncus, quis sodales eros congue.$$$###$$$Vivamus scelerisque massa nec accumsan finibus.$$$###$$$MULTIPLE$$$###$$$CATEGORY_2$$$###$$$7eb57526-b4bd-4a42-9396-dacbf73274c8$$$###$$$Curabitur egestas leo ut mi molestie faucibus.$$$###$$$Ut id justo in velit viverra interdum sed vitae enim.$$$###$$$FALSE$$$###$$$2$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$8d05035e-424f-4680-938b-8c3fa878deaf$$$###$$$Cras non tellus sodales leo ullamcorper blandit a eget tortor.$$$###$$$Aliquam egestas massa tincidunt turpis volutpat finibus.$$$###$$$FALSE$$$###$$$3$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$8ec07d17-6a93-4db8-9841-c3ce707e707f$$$###$$$Etiam at neque imperdiet, posuere nibh et, egestas est.$$$###$$$Nulla at dolor id lectus ornare luctus a eget purus.$$$###$$$FALSE$$$###$$$3$$$###$$$4c7b9cc0-b9d4-4d9e-ab14-850c61df53de$$$###$$$EN$$$###$$$Second Step$$$###$$$Suspendisse sagittis orci non ex rutrum, at molestie libero viverra.$$$###$$$1d828efc-5983-4c9f-8dec-31aed522d1eb$$$###$$$Vestibulum vitae odio nec sapien vestibulum interdum non nec quam.$$$###$$$Ut fermentum leo at risus rhoncus pellentesque.$$$###$$$SINGLE$$$###$$$CATEGORY_1$$$###$$$b1f50f58-2387-486e-9b42-af00ed35ccbe$$$###$$$Vivamus eget orci vehicula, feugiat dolor non, tincidunt est.$$$###$$$Sed a nunc vitae magna dapibus ultricies.$$$###$$$FALSE$$$###$$$4$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$a8b59aec-ec15-44d4-9fe6-f67c1df60880$$$###$$$Etiam imperdiet massa consequat pellentesque lacinia.$$$###$$$Curabitur et sem tristique, tempor sapien at, maximus elit.$$$###$$$FALSE$$$###$$$4$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$4c7b9cc0-b9d4-4d9e-ab14-850c61df53de$$$###$$$Nunc dignissim lacus at sapien vulputate, ac scelerisque dui vulputate.$$$###$$$Vivamus a magna sodales, aliquet sapien sed, pellentesque quam.$$$###$$$MULTIPLE$$$###$$$CATEGORY_2$$$###$$$9f2a20e4-f3ae-495d-b254-99d239295dc6$$$###$$$Fusce posuere sem eget auctor aliquam.$$$###$$$Nam eu nunc elementum, congue lectus sit amet, euismod tortor.$$$###$$$FALSE$$$###$$$4$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$cd1c3a27-a2db-42d6-8a3a-9dea67305eb6$$$###$$$Morbi eget magna auctor, feugiat turpis in, facilisis felis.$$$###$$$Morbi ultricies justo in lectus ultrices, ut interdum est vulputate.$$$###$$$FALSE$$$###$$$5$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$7e4529bb-5a34-4384-8c2c-5b470d054a69$$$###$$$Cras lacinia libero ut urna sollicitudin, a ornare dolor accumsan.$$$###$$$Vestibulum congue eros laoreet nulla egestas pellentesque.$$$###$$$FALSE$$$###$$$4$$$###$$$7ff61900-cc7d-43f6-9eef-7b8d4eae3114$$$###$$$ES$$$###$$$Preguntas iniciales$$$###$$$Nam maximus ipsum quis diam fermentum posuere.$$$###$$$638a93e9-0d6d-4d80-8b13-25ad232206b0$$$###$$$Sed vel lorem gravida, dictum lorem in, commodo mi.$$$###$$$Aliquam ultricies neque sed tellus consequat hendrerit ut finibus lectus.$$$###$$$MULTIPLE$$$###$$$CATEGORY_1$$$###$$$16ba7561-6f0e-452f-8a8c-38ba3b9a061a$$$###$$$Nunc maximus quam commodo dolor finibus aliquet.$$$###$$$Nunc pharetra felis quis aliquet eleifend.$$$###$$$FALSE$$$###$$$5$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$CATEGORY_2$$$###$$$ae1f9624-370f-43c0-bfa5-7d3f2d4da297$$$###$$$Etiam efficitur magna eu magna ultricies, ut feugiat mi dignissim.$$$###$$$Praesent blandit ex quis leo molestie imperdiet.$$$###$$$FALSE$$$###$$$5$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$CATEGORY_1$$$###$$$3c5a3650-5071-4e31-8621-9b8675ef3b6c$$$###$$$Donec eu diam volutpat, ullamcorper erat ut, feugiat orci.$$$###$$$Etiam bibendum velit eget justo interdum malesuada.$$$###$$$FALSE$$$###$$$5$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$CATEGORY_1$$$###$$$eba69599-e22f-46b6-b6bd-e162744f75c6$$$###$$$Fusce a sapien tincidunt, condimentum mauris a, finibus metus.$$$###$$$Integer gravida nisl ut pellentesque dictum.$$$###$$$FALSE$$$###$$$4$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$CATEGORY_2$$$###$$$180c09f0-67ec-4f23-bdab-d6332699907c$$$###$$$Morbi hendrerit tellus sed erat pellentesque, nec lacinia tellus ullamcorper.$$$###$$$Duis at magna nec lectus suscipit sollicitudin vel sed dolor.$$$###$$$FALSE$$$###$$$3$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$CATEGORY_1$$$###$$$54127816-e45c-461b-b8b1-82b6762b1dfd$$$###$$$Cras luctus quam et lectus vehicula tempus.$$$###$$$Vestibulum blandit justo vitae massa dictum, non suscipit quam scelerisque.$$$###$$$FALSE$$$###$$$2$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$CATEGORY_2$$$###$$$b5bfb950-bccb-4580-97ea-82ca34327460$$$###$$$Fusce eu erat eu velit luctus ornare.$$$###$$$Phasellus rhoncus tellus sit amet ligula cursus, ac euismod orci bibendum.$$$###$$$FALSE$$$###$$$1$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$d10e1059-e4e8-4ee4-b45c-e880c788a8cd$$$###$$$Mauris ac ligula fermentum, consectetur tortor et, suscipit ex.$$$###$$$Nunc non est ut quam lacinia vehicula eu nec ligula.$$$###$$$MULTIPLE$$$###$$$CATEGORY_2$$$###$$$aaf82452-ed8d-4423-a944-2452ecc5e6fc$$$###$$$Suspendisse pellentesque eros sed nunc euismod euismod.$$$###$$$Morbi sit amet nisl a urna varius pharetra ut non erat.$$$###$$$FALSE$$$###$$$5$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$CATEGORY_1$$$###$$$72daee43-2b5a-44df-b894-3707bcbca3c2$$$###$$$Aliquam blandit nulla in nunc dignissim dignissim.$$$###$$$Donec in nisl at dui egestas euismod.$$$###$$$FALSE$$$###$$$0$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$CATEGORY_1$$$###$$$c4b90e62-9080-4780-a89b-862ab128194d$$$###$$$In sed ante id felis dapibus porttitor et ut ligula.$$$###$$$Quisque et lectus pharetra, tempor dui nec, euismod nisl.$$$###$$$FALSE$$$###$$$4$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$CATEGORY_2$$$###$$$dee80de6-0d8d-4be0-926e-75b81aa4f8e3$$$###$$$Vivamus lacinia tellus nec sodales iaculis.$$$###$$$Quisque aliquet quam vel posuere sollicitudin.$$$###$$$FALSE$$$###$$$2$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$CATEGORY_1$$$###$$$80816a0b-e8c5-4334-ab54-e5828ac74e38$$$###$$$In eget risus vitae mauris dignissim venenatis nec eget justo.$$$###$$$Sed euismod leo sed felis ultricies, sed rhoncus nibh ornare.$$$###$$$FALSE$$$###$$$3$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$CATEGORY_2$$$###$$$4d7b0e0d-5f59-48a5-81da-54e566fbb1e5$$$###$$$Mauris dictum sem nec sapien porttitor, et accumsan lacus pellentesque.$$$###$$$Fusce sed ligula at lorem faucibus placerat quis ac nibh.$$$###$$$FALSE$$$###$$$3$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$CATEGORY_2$$$###$$$aed2ce90-6599-436d-be72-6195840aaab3$$$###$$$Vestibulum tristique nunc sit amet leo egestas, consequat porttitor magna tincidunt.$$$###$$$Nulla a felis ut nulla semper congue eget at magna.$$$###$$$FALSE$$$###$$$3$$$###$$$dcb2d0d0-26a5-4f87-8e21-8af38f3624d8$$$###$$$EN$$$###$$$Initial questions$$$###$$$Curabitur pellentesque velit nec tincidunt congue.$$$###$$$604be922-94b0-4b35-b6c0-218961faba6d$$$###$$$Praesent in ligula ultricies, gravida tortor eget, faucibus risus.$$$###$$$Aliquam dapibus massa sit amet sem lobortis, vitae efficitur orci commodo.$$$###$$$MULTIPLE$$$###$$$CATEGORY_1$$$###$$$25892bc8-cd1c-4cfd-8201-eb2fbd5da379$$$###$$$Cras eu magna ac lorem commodo placerat.$$$###$$$Donec dapibus erat et nibh ultricies venenatis.$$$###$$$FALSE$$$###$$$5$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$CATEGORY_2$$$###$$$6f84c46a-e44e-4cbc-89f6-469191793f79$$$###$$$Aliquam at lectus vitae ex bibendum dapibus in sit amet metus.$$$###$$$Morbi posuere odio a ante malesuada pharetra.$$$###$$$FALSE$$$###$$$5$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$CATEGORY_1$$$###$$$66200660-c79a-4efd-84d9-d4b6537e7ae6$$$###$$$Quisque suscipit elit vitae placerat feugiat.$$$###$$$Praesent hendrerit lacus aliquam, facilisis purus in, pharetra leo.$$$###$$$FALSE$$$###$$$5$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$CATEGORY_1$$$###$$$de02b311-32bd-4be5-a9ef-2b5f15e8987b$$$###$$$Sed tristique enim ac justo ullamcorper ornare.$$$###$$$Praesent cursus magna nec lectus aliquam molestie.$$$###$$$FALSE$$$###$$$4$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$CATEGORY_2$$$###$$$09a34706-cb86-4be0-b22b-fa0ba013b1e7$$$###$$$Curabitur non turpis finibus, euismod massa a, feugiat urna.$$$###$$$Suspendisse a leo nec lorem pretium aliquet.$$$###$$$FALSE$$$###$$$3$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$CATEGORY_1$$$###$$$14fe1eab-598a-45c0-a798-c9c2e96a808a$$$###$$$Nunc consequat leo et fringilla vestibulum.$$$###$$$Nullam quis ante sed lorem rutrum aliquet nec malesuada quam.$$$###$$$FALSE$$$###$$$2$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$CATEGORY_2$$$###$$$65861bde-592f-4125-a8a3-f486203a343e$$$###$$$Donec consectetur tortor vitae libero volutpat, ac auctor ex commodo.$$$###$$$Aliquam euismod massa quis odio egestas venenatis.$$$###$$$FALSE$$$###$$$1$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$b3520566-5e97-442b-9899-6be3852e1ae1$$$###$$$Nunc convallis libero eu felis interdum, imperdiet laoreet augue auctor.$$$###$$$Integer iaculis est at efficitur semper.$$$###$$$MULTIPLE$$$###$$$CATEGORY_2$$$###$$$ac1f5288-f694-4f67-9e7b-9e4df4fe491f$$$###$$$Phasellus vitae turpis non ante pulvinar suscipit nec in orci.$$$###$$$In quis ipsum sed nulla facilisis mattis.$$$###$$$FALSE$$$###$$$5$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$CATEGORY_1$$$###$$$5fbecf7e-7642-4d4d-9031-3f5b26794996$$$###$$$Sed tempus mauris non tellus maximus viverra non eget eros.$$$###$$$Nam euismod sem vel neque gravida, a pellentesque est vehicula.$$$###$$$FALSE$$$###$$$1$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$CATEGORY_1$$$###$$$c2327292-6142-4e69-aa57-2d85d13a2a94$$$###$$$Duis vel purus sit amet sapien pharetra aliquam.$$$###$$$Donec ac erat in dui dictum pulvinar.$$$###$$$FALSE$$$###$$$4$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$CATEGORY_2$$$###$$$943c0696-dac1-4af4-958e-ec9cf2397c0d$$$###$$$Sed ultrices massa non dui molestie elementum.$$$###$$$Pellentesque efficitur est et velit auctor, ac fringilla orci tristique.$$$###$$$FALSE$$$###$$$2$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$CATEGORY_1$$$###$$$3e3a3f1e-dc62-4beb-8b26-88986b8f4cfc$$$###$$$Aliquam ut lectus sit amet felis faucibus fringilla id ut quam.$$$###$$$Proin elementum ligula et nisi dignissim ullamcorper.$$$###$$$FALSE$$$###$$$3$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$CATEGORY_2$$$###$$$3ebf1026-342f-4c50-b100-d3cfd8e6c8ad$$$###$$$Nullam pharetra eros dapibus arcu tempus auctor.$$$###$$$Phasellus in nisl porttitor, porttitor nisl et, elementum nisi.$$$###$$$FALSE$$$###$$$3$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$$$$###$$$CATEGORY_2$$$###$$$e8f16770-b70e-4688-8ff1-bdfaf4d5f812$$$###$$$Proin in dolor at enim dapibus fringilla vitae tincidunt magna.$$$###$$$Morbi commodo dui eget nisl efficitur, euismod congue ipsum semper.$$$###$$$FALSE$$$###$$$3";

    @Test
    public void testStringArrayToBean() throws InternalBraaSException, IOException {
        SpreadsheetRuleUtils spreadsheetRuleUtils = new SpreadsheetRuleUtils(matrixStr, fieldSeparator, headerSeparator);
        Collection<Form> result = spreadsheetRuleUtils.stringArrayToBeans(prefix, Form.class);
        System.out.println(jsonUtils.toJSON(result));
    }

    @Test
    public void testFixMatrix() throws InternalBraaSException, IOException {
        SpreadsheetRuleUtils spreadsheetRuleUtils = new SpreadsheetRuleUtils(matrixStr, fieldSeparator, headerSeparator);
        String[] result = spreadsheetRuleUtils.buildMatrix();
        Assert.assertEquals(2172, result.length);
        System.out.println(jsonUtils.toJSON(result));
    }

    @Test
    public void testGetIntervals() throws InternalBraaSException, IOException {
        SpreadsheetRuleUtils spreadsheetRuleUtils = new SpreadsheetRuleUtils(matrixStr, fieldSeparator, headerSeparator);
        LinkedList<SpreadsheetRuleUtils.Interval> result = spreadsheetRuleUtils.getIntervals();
        Assert.assertEquals(6, result.size());
        System.out.println(jsonUtils.toJSON(result));
    }

    @Test
    public void testGetIntervals2() throws InternalBraaSException, IOException {
        SpreadsheetRuleUtils spreadsheetRuleUtils = new SpreadsheetRuleUtils(matrixStr, fieldSeparator, headerSeparator);
        LinkedList<SpreadsheetRuleUtils.Interval> result = spreadsheetRuleUtils.getIntervals(5, 344);
        System.out.println(jsonUtils.toJSON(result));
    }
}
